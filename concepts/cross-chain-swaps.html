
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cross-Chain Swaps &#8212; Symbol Developers</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:400,400i,700&display=swap" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/examplecode.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Master',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/custom.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/examplecode.js"></script>
    <script type="text/javascript" src="https://unpkg.com/mermaid@7.1.0/dist/mermaid.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon-32x32.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extending Symbol" href="plugin.html" />
    <link rel="prev" title="Multisig Account" href="multisig-account.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=5'>
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
<script type="text/javascript">
    var _paq = window._paq || [];
    _paq.push(['disableCookies']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
        var u="https://nemtech.matomo.cloud/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '1']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/nemtech.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
    })();
</script>

  
  <link rel="alternate" type="application/atom+xml"  href="../guides/atom.xml" title="Blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body>

<div class="navbar navbar-default gradient navbar-fixed-top"
     id="navbar">
    <div class="container navbar-top hidden-xs hidden-sm">
        <div class="row">
            <div class="col-lg-8 col-md-7">
                <div id="language">
    <label class="select">
        <select>
            <option id="english" value="en">EN</option>
            <option id="japanese" value="ja">JA</option>
            <!--<option id="chinese" value="zh_CN">中文</option>-->
            <option id="translate" value="translate">Translate</option>
        </select>
    </label>
</div>
            </div>
            <div class="col-lg-4 col-md-5">
                
                <div id="search-box">
    <input class="search search-desktop form-control" placeholder="Search"/>
</div>
                
                <ul id="social" class="list-inline">
    <li>
        <a href="https://twitter.com/NEMofficial" rel="nofollow"><i class="fab fa-twitter"></i></a>
    </li>
    <li>
        <a href="https://join.slack.com/t/nem2/shared_invite/enQtMzY4MDc2NTg0ODgyLWZmZWRiMjViYTVhZjEzOTA0MzUyMTA1NTA5OWQ0MWUzNTA4NjM5OTJhOGViOTBhNjkxYWVhMWRiZDRkOTE0YmU"
           rel="nofollow"><i class="fab fa-slack"></i></a>
    </li>
    <li>
        <a href="https://github.com/nemtech/" rel="nofollow"><i class="fab fa-github"></i></a>
    </li>
</ul>
            </div>
        </div>
    </div>
    <hr/>
    <div class="container navbar-main">
        <div class="row">
            <div class="navbar-header col-lg-6 col-md-4 col-xs-6">
                <a class="navbar-brand" href="../index.html">
                    
                    <span><img alt="NEM logo" src="../_static/logo-symbol.svg"></span>
                    
                </a>
            </div>
            <div class="navbar-right col-lg-6 col-md-8 hidden-xs hidden-sm">
                <ul class="list-inline">
    <li>
        <a href="/" class="active">Developers</a>
    </li>
</ul>
            </div>
            <div class="navbar-right col-xs-6 hidden-lg hidden-md">
                
                <div id="search-box">
    <input class="search search-mobile form-control" placeholder="Search"/>
</div>
                

            </div>
        </div>
        <div class="row">
            <div class="col-md-12 sidebar-xs visible-xs visible-sm">
                <div class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Navigation <b
                            class="caret"></b></a>
                    <ul class="dropdown-menu globaltoc"><p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/setup-workstation.html">Setting up your workstation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/first-application.html">Writing your first application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/migration/migrating-from-nem-to-symbol.html">Migrating from NEM to Symbol</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/account/creating-an-account.html">Creating an account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/transfer/sending-a-transfer-transaction.html">Sending mosaics and messages between two accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/mosaic/creating-a-mosaic.html">Creating a mosaic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/multisig/creating-a-multisig-account.html">Creating a multisig account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/network/running-a-test-net-node.html">Running a test net node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/network/creating-a-private-test-net.html">Creating a private test net</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nemtech.github.io/guides/category.html">More guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Built-in Features</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="mosaic.html">Mosaic</a></li>
<li class="toctree-l1"><a class="reference internal" href="namespace.html">Namespace</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfer-transaction.html">Transfer Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-transaction.html">Aggregate Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="account-restriction.html">Account Restriction</a></li>
<li class="toctree-l1"><a class="reference internal" href="mosaic-restriction.html">Mosaic Restriction</a></li>
<li class="toctree-l1"><a class="reference internal" href="multisig-account.html">Multisig Account</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cross-Chain Swaps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#protocol">Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="#guides">Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transaction-schemas">Transaction schemas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#secretlocktransaction">SecretLockTransaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secretprooftransaction">SecretProofTransaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lockhashalgorithm">LockHashAlgorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugin.html">Extending Symbol</a></li>
</ul>
<p class="caption"><span class="caption-text">Protocol</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cryptography.html">Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="block.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="fees.html">Fees</a></li>
<li class="toctree-l1"><a class="reference internal" href="receipt.html">Receipt</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-validation.html">Data Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="consensus-algorithm.html">Consensus</a></li>
<li class="toctree-l1"><a class="reference internal" href="harvesting.html">Harvesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="inflation.html">Inflation</a></li>
<li class="toctree-l1"><a class="reference internal" href="node.html">Node</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nemtech.github.io/catapult-whitepaper/main.pdf">Whitepaper</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">REST Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdk.html">SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wallets.html">Wallets</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribute</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/contributing.html">Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/contributors.html">Contributors</a></li>
</ul>
</ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        
        

<div class="col-md-3">
    <div id="sidebar" class="bs-sidenav" role="complementary">
        
        <div class="sidebar-md hidden-xs hidden-sm">
    <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/setup-workstation.html">Setting up your workstation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/first-application.html">Writing your first application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/migration/migrating-from-nem-to-symbol.html">Migrating from NEM to Symbol</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/account/creating-an-account.html">Creating an account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/transfer/sending-a-transfer-transaction.html">Sending mosaics and messages between two accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/mosaic/creating-a-mosaic.html">Creating a mosaic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/multisig/creating-a-multisig-account.html">Creating a multisig account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/network/running-a-test-net-node.html">Running a test net node</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/network/creating-a-private-test-net.html">Creating a private test net</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nemtech.github.io/guides/category.html">More guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Built-in Features</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="account.html">Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="mosaic.html">Mosaic</a></li>
<li class="toctree-l1"><a class="reference internal" href="namespace.html">Namespace</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfer-transaction.html">Transfer Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="aggregate-transaction.html">Aggregate Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="account-restriction.html">Account Restriction</a></li>
<li class="toctree-l1"><a class="reference internal" href="mosaic-restriction.html">Mosaic Restriction</a></li>
<li class="toctree-l1"><a class="reference internal" href="multisig-account.html">Multisig Account</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cross-Chain Swaps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#protocol">Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="#guides">Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transaction-schemas">Transaction schemas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#secretlocktransaction">SecretLockTransaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secretprooftransaction">SecretProofTransaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lockhashalgorithm">LockHashAlgorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugin.html">Extending Symbol</a></li>
</ul>
<p class="caption"><span class="caption-text">Protocol</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cryptography.html">Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="block.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="fees.html">Fees</a></li>
<li class="toctree-l1"><a class="reference internal" href="receipt.html">Receipt</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-validation.html">Data Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="consensus-algorithm.html">Consensus</a></li>
<li class="toctree-l1"><a class="reference internal" href="harvesting.html">Harvesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="inflation.html">Inflation</a></li>
<li class="toctree-l1"><a class="reference internal" href="node.html">Node</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nemtech.github.io/catapult-whitepaper/main.pdf">Whitepaper</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">REST Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server.html">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sdk.html">SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wallets.html">Wallets</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribute</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute/community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/contributing.html">Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/contributors.html">Contributors</a></li>
</ul>

    <p class="version">
        <small><b>Version:</b> <a href="https://github.com/nemtech/nem2-docs/releases">0.21.4</a></small>
    </p>
</div>
        
    </div>
</div>


        
        <div class="col-md-7 content">
            
  <div class="section" id="cross-chain-swaps">
<h1>Cross-Chain Swaps<a class="headerlink" href="#cross-chain-swaps" title="Permalink to this headline">¶</a></h1>
<p>A cross-chain swap enables trading tokens across different blockchains without using an intermediary party (e.g. an exchange service) in the process.</p>
<div class="figure align-center" id="id1">
<img alt="../_images/cross-chain-swap.png" src="../_images/cross-chain-swap.png" style="width: 500px;" />
<p class="caption"><span class="caption-text">Cross-chain swap between public and private network</span></p>
</div>
<p>Symbol follows the <strong>Hashed TimeLock Contract</strong> (HTLC) protocol to create a trustless environment for the decentralized exchange of assets. The protocol guarantees that if all participants agree, the swap will take place. On the other hand, if some of them decide not to conclude the process, each participant should receive their locked funds back.</p>
<p>HTLC uses <em>hashlocks</em> and <em>timelocks</em> to reduce the counterparty risk.
Every participant in the exchange of tokens needs to present proof (hashlock) to complete it. Failing to do so, the locked assets are released back to each original owner after the timelock expires.</p>
<p>A thorough explanation of the protocol can be found on the <a class="reference external" href="https://en.bitcoin.it/wiki/Hashed_Timelock_Contracts">Bitcoin Wiki</a>.</p>
<div class="section" id="protocol">
<h2>Protocol<a class="headerlink" href="#protocol" title="Permalink to this headline">¶</a></h2>
<p>Alice and Bob want to exchange <strong>10 alice.tokens for 10 bob.tokens</strong>.</p>
<p>The problem is that they are not in the same network: alice.token is defined in Symbol’s public chain whereas bob.token is only present in a private chain using Symbol tech.</p>
<p>Trading tokens directly from one blockchain to the other is not possible, due to the technological differences between them.</p>
<p>In the case of Symbol public and private chain, the same mosaic name could have a different definition and distribution or even not exist.
Between Bitcoin and Symbol, the difference is even more evident, as each blockchain uses an entirely different technology.</p>
<p>Instead of transferring tokens between different chains literally, the trade will be performed inside each chain.</p>
<p>The cross chan swap protocol will ensure that the token swap occurs atomically.</p>
<div class="figure align-center" id="id2">

            <style>
            /* mermaid issue 527 workaround */
            .section {
                opacity: 1.0 !important;
            }
            </style>
            <script>mermaid.initialize({startOnLoad:true});</script><div class="mermaid">
            sequenceDiagram
    participant Alice
    participant Private Chain
    participant Public Chain
    participant Bob
    Note over Alice: proof = 'random'
    Note over Alice: h = sha_256()
    Note over Alice: secret = h(proof)
    Alice -&gt;&gt;  Private Chain: announces TX1(secret)
    Note right of Alice: TX1 waits for proof
    Alice --&gt;&gt; Bob: tells secret
    Bob -&gt;&gt; Public Chain: announces TX2(secret)
    Note left of Bob: TX2 waits for proof
    Alice -&gt;&gt;  Public Chain: announces TX3(proof, secret)
    Note left of Public Chain: proof becomes public
    Note left of Bob: TX2 executes
    Note left of Bob: Alice receives funds
    Bob -&gt;&gt;  Private Chain: announces TX4(proof, secret)
    Note right of Alice: TX1 executes
    Note right of Alice: Bob receives funds

        </div><p class="caption"><span class="caption-text">Cross-chain swap sequence diagram</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>Before starting with the swap, all participants involved int the swap must own at least one account in each blockchain.</p>
<ol class="arabic simple">
<li>Alice generates a random set of bytes called <code class="docutils literal"><span class="pre">proof</span></code>. The proof should have a size between <code class="docutils literal"><span class="pre">10</span></code> and <code class="docutils literal"><span class="pre">1000</span></code> bytes.</li>
<li>Alice hashes the obtained proof with one of the <a class="reference internal" href="#lock-hash-algorithm"><span class="std std-ref">available algorithms</span></a> to generate the <code class="docutils literal"><span class="pre">secret</span></code>.</li>
<li>Alice defines the <a class="reference internal" href="#secret-lock-transaction"><span class="std std-ref">SecretLockTransaction</span></a> <strong>TX1</strong>:</li>
</ol>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TX1 Property</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Type</td>
<td>SecretLockTransaction</td>
</tr>
<tr class="row-odd"><td>Mosaic</td>
<td>10 alice.token</td>
</tr>
<tr class="row-even"><td>Recipient</td>
<td>Bob’s address (Private Chain)</td>
</tr>
<tr class="row-odd"><td>Algorithm</td>
<td>h</td>
</tr>
<tr class="row-even"><td>Duration</td>
<td>96 h</td>
</tr>
<tr class="row-odd"><td>Secret</td>
<td>h(proof)</td>
</tr>
<tr class="row-even"><td>Network</td>
<td>Private Chain</td>
</tr>
</tbody>
</table>
<p>Once announced, this transaction will remain locked until someone discovers the proof that matches the secret. If no one unlocks it before the duration set is reached, the locked funds will be returned back to Alice.</p>
<ol class="arabic simple" start="4">
<li>Alice <strong>announces TX1 to the private network</strong> and <strong>shares with Bob the secret</strong>.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bob should retrieve the secret from the chain. It is Bob’s responsibility to verify the secret correctness.</p>
</div>
<ol class="arabic simple" start="5">
<li>Bob defines announces the following <strong>SecretLockTransaction TX2</strong> to the <strong>public network</strong>:</li>
</ol>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TX2 Property</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Type</td>
<td>SecretLockTransaction</td>
</tr>
<tr class="row-odd"><td>Mosaic</td>
<td>10 bob.token</td>
</tr>
<tr class="row-even"><td>Recipient</td>
<td>Alice’s address (Public Chain)</td>
</tr>
<tr class="row-odd"><td>Algorithm</td>
<td>h</td>
</tr>
<tr class="row-even"><td>Duration</td>
<td>84 h</td>
</tr>
<tr class="row-odd"><td>Secret</td>
<td>h(proof)</td>
</tr>
<tr class="row-even"><td>Network</td>
<td>Public Chain</td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="6">
<li>Alice announces the <a class="reference internal" href="#secret-proof-transaction"><span class="std std-ref">SecretProofTransaction</span></a> <strong>TX3</strong> to the <strong>public network</strong>. This transaction defines the encrypting algorithm used, the original proof and the secret:</li>
</ol>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TX3 Property</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Type</td>
<td>SecretProofTransaction</td>
</tr>
<tr class="row-odd"><td>Recipient</td>
<td>Alice’s address (Public Chain)</td>
</tr>
<tr class="row-even"><td>Algorithm</td>
<td>h</td>
</tr>
<tr class="row-odd"><td>Secret</td>
<td>h(proof)</td>
</tr>
<tr class="row-even"><td>Proof</td>
<td>proof</td>
</tr>
<tr class="row-odd"><td>Network</td>
<td>Public Chain</td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="7">
<li>Once TX3 is confirmed, the <strong>proof</strong> is revealed. <strong>TX2 transaction is unlocked</strong>, and Alice receives the locked funds.</li>
<li>Bob picks the proof and announces the <strong>SecretProofTransaction TX4</strong> to the <strong>private network</strong>, receiving the locked funds from <strong>TX1</strong>.</li>
</ol>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">TX4 Property</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Type</td>
<td>SecretProofTransaction</td>
</tr>
<tr class="row-odd"><td>Recipient</td>
<td>Bob’s address (Private Chain)</td>
</tr>
<tr class="row-even"><td>Algorithm</td>
<td>h</td>
</tr>
<tr class="row-odd"><td>Secret</td>
<td>h(proof)</td>
</tr>
<tr class="row-even"><td>Proof</td>
<td>proof</td>
</tr>
<tr class="row-odd"><td>Network</td>
<td>Private Chain</td>
</tr>
</tbody>
</table>
<p>The process is atomic, but should be completed with lots of time before the deadlines:</p>
<ul class="simple">
<li>TX1’s duration should be significantly bigger than TX2’s to guarantee that the second participant will have time to unlock TX1 after the first one reveals the proof.</li>
<li>Each participant must wait for at least <code class="docutils literal"><span class="pre">maxRollBackBlocks</span></code> between announcements to prevent experiencing <a class="reference internal" href="block.html#rollbacks"><span class="std std-ref">transaction rollbacks</span></a>.</li>
</ul>
</div>
<div class="section" id="guides">
<h2>Guides<a class="headerlink" href="#guides" title="Permalink to this headline">¶</a></h2>
<ul class="postlist-style-circle postlist">
<li><p class="first"><a class="reference internal" href="../guides/secretlock/atomic-cross-chain-swap-between-NEM-public-and-private-chain.html">Atomic cross-chain swap between public and private chain</a></p>
<p>Trade tokens between different blockchains without using an intermediary party in the process.</p>
</li>
</ul>
</div>
<div class="section" id="transaction-schemas">
<h2>Transaction schemas<a class="headerlink" href="#transaction-schemas" title="Permalink to this headline">¶</a></h2>
<div class="section" id="secretlocktransaction">
<span id="secret-lock-transaction"></span><h3>SecretLockTransaction<a class="headerlink" href="#secretlocktransaction" title="Permalink to this headline">¶</a></h3>
<p>Use a SecretLockTransaction to transfer mosaics between two accounts. The specified mosaics remain locked until a valid <a class="reference internal" href="#secret-proof-transaction"><span class="std std-ref">SecretProofTransaction</span></a> unlocks them.</p>
<p>The maximum number of blocks the lock can lie up to is <code class="docutils literal"><span class="pre">30</span> <span class="pre">days</span></code>, being this parameter <a class="reference internal" href="../guides/network/configuring-network-properties.html#config-network-properties"><span class="std std-ref">configurable per network</span></a>.
If the transaction duration is reached without being proved, the locked amount goes back to the initiator of the SecretLockTransaction.</p>
<p><strong>Version</strong>: 0x01</p>
<p><strong>EntityType</strong>: 0x4152</p>
<p><strong>Inlines</strong>:</p>
<ul class="simple">
<li><a class="reference internal" href="transaction.html#id2"><span class="std std-ref">Transaction</span></a> or <a class="reference internal" href="transaction.html#embedded-transaction"><span class="std std-ref">EmbeddedTransaction</span></a></li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>secret</td>
<td><a class="reference external" href="https://github.com/nemtech/catbuffer/blob/master/schemas/types.cats">Hash256</a></td>
<td>Proof hashed.</td>
</tr>
<tr class="row-odd"><td>mosaic</td>
<td><a class="reference internal" href="mosaic.html#unresolved-mosaic"><span class="std std-ref">UnresolvedMosaic</span></a></td>
<td>Locked mosaic.</td>
</tr>
<tr class="row-even"><td>duration</td>
<td><a class="reference external" href="https://github.com/nemtech/catbuffer/blob/master/schemas/types.cats">BlockDuration</a></td>
<td>Number of blocks for which a lock should be valid. If reached, the mosaics will be returned to the initiator.</td>
</tr>
<tr class="row-odd"><td>hashAlgorithm</td>
<td><a class="reference internal" href="#lock-hash-algorithm"><span class="std std-ref">LockHashAlgorithm</span></a></td>
<td>Algorithm used to hash the proof.</td>
</tr>
<tr class="row-even"><td>recipientAddress</td>
<td><a class="reference external" href="https://github.com/nemtech/catbuffer/blob/master/schemas/types.cats">UnresolvedAddress</a></td>
<td>Address that receives the funds once unlocked.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="secretprooftransaction">
<span id="secret-proof-transaction"></span><h3>SecretProofTransaction<a class="headerlink" href="#secretprooftransaction" title="Permalink to this headline">¶</a></h3>
<p>Use a SecretProofTransaction to unlock <a class="reference internal" href="#secret-lock-transaction"><span class="std std-ref">SecretLockTransactions</span></a>.</p>
<p>The transaction must prove that it knows the <em>proof</em> that unlocks the mosaics.</p>
<p><strong>Version</strong>: 0x01</p>
<p><strong>EntityType</strong>: 0x4252</p>
<p><strong>Inlines</strong>:</p>
<ul class="simple">
<li><a class="reference internal" href="transaction.html#id2"><span class="std std-ref">Transaction</span></a> or <a class="reference internal" href="transaction.html#embedded-transaction"><span class="std std-ref">EmbeddedTransaction</span></a></li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>secret</td>
<td><a class="reference external" href="https://github.com/nemtech/catbuffer/blob/master/schemas/types.cats">Hash256</a></td>
<td>Proof hashed.</td>
</tr>
<tr class="row-odd"><td>proofSize</td>
<td>uint16</td>
<td>Proof size in bytes.</td>
</tr>
<tr class="row-even"><td>hashAlgorithm</td>
<td><a class="reference internal" href="#lock-hash-algorithm"><span class="std std-ref">LockHashAlgorithm</span></a></td>
<td>Algorithm used to hash the proof.</td>
</tr>
<tr class="row-odd"><td>recipientAddress</td>
<td><a class="reference external" href="https://github.com/nemtech/catbuffer/blob/master/schemas/types.cats">UnresolvedAddress</a></td>
<td>Address that receives the funds once unlocked.</td>
</tr>
<tr class="row-even"><td>proof</td>
<td>array(byte, proofSize)</td>
<td>Original random set of bytes.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="lockhashalgorithm">
<span id="lock-hash-algorithm"></span><h3>LockHashAlgorithm<a class="headerlink" href="#lockhashalgorithm" title="Permalink to this headline">¶</a></h3>
<p>The list of supported hashing algorithms.</p>
<p>Enumeration: uint8</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Id</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0 (Op_Sha3_256)</td>
<td>Proof is hashed using SHA3-256.</td>
</tr>
<tr class="row-odd"><td>1 (Op_Hash_160)</td>
<td>Proof is hashed twice: first with SHA-256 and then with RIPEMD-160 (bitcoin’s OP_HASH160).</td>
</tr>
<tr class="row-even"><td>2 (Op_Hash_256)</td>
<td>Proof is hashed twice with SHA-256 (bitcoin’s OP_HASH256).</td>
</tr>
</tbody>
</table>
<p>Continue: <a class="reference internal" href="cryptography.html"><span class="doc">Cryptography</span></a>.</p>
</div>
</div>
</div>

  <div class="section">
  
  
  </div>

            
            <p class="feedback">
                <b>Did you find what you were looking for?</b>
                <a href="https://github.com/nemtech/symbol-docs/issues/new/choose" target="_blank">Give us your feedback.</a>
            </p>
            
        </div>
         

<div class="col-md-2">
    <div class="bs-sidenav secondary" role="complementary">
        <div class="edit-github">
    <a href="https://github.com/nemtech/symbol-docs/edit/master/source/concepts/cross-chain-swaps.rst" rel="nofollow"> <i class="fab fa-github"></i> Improve this page</a>
</div>
        <span class="title">On this page</span>
        <ul>
<li><a class="reference internal" href="#">Cross-Chain Swaps</a><ul>
<li><a class="reference internal" href="#protocol">Protocol</a></li>
<li><a class="reference internal" href="#guides">Guides</a></li>
<li><a class="reference internal" href="#transaction-schemas">Transaction schemas</a><ul>
<li><a class="reference internal" href="#secretlocktransaction">SecretLockTransaction</a></li>
<li><a class="reference internal" href="#secretprooftransaction">SecretProofTransaction</a></li>
<li><a class="reference internal" href="#lockhashalgorithm">LockHashAlgorithm</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</div>

 
    </div>
</div>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: 'fea87a364e2d51e3729a3a4889f7fe61',
        indexName: 'nemtech',
        inputSelector: '.search-desktop',
        debug: false
    });

    docsearch({
        apiKey: 'fea87a364e2d51e3729a3a4889f7fe61',
        indexName: 'nemtech',
        inputSelector: '.search-mobile',
        debug: false
    });
</script>

  </body>
</html>